<!DOCTYPE html>
<html lang="nl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AVG Anonimiseer - Document Redactie Tool</title>
    <meta name="description"
        content="Anonimiseer documenten AVG-proof. Verwijder persoonsgegevens veilig met automatische detectie en echte redactie.">
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- PDF.js for rendering -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        if (typeof pdfjsLib !== 'undefined') {
            pdfjsLib.GlobalWorkerOptions.workerSrc = '';
        }
    </script>
    <!-- pdf-lib for manipulation -->
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
</head>

<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <span class="logo-icon">üîí</span>
                <h1>AVG Anonimiseer</h1>
            </div>
            <p class="tagline">100% lokaal ‚Ä¢ Geen uploads ‚Ä¢ Veilige redactie</p>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Upload Zone -->
            <div id="upload-zone" class="upload-zone">
                <div class="upload-content">
                    <div class="upload-icon">üìÑ</div>
                    <h2>Sleep een document hierheen</h2>
                    <p>PDF of afbeelding (JPG/PNG)</p>
                    <input type="file" id="file-input" accept=".pdf,.jpg,.jpeg,.png" hidden>
                    <button class="btn btn-primary" id="browse-btn">Bestand kiezen</button>
                </div>
                <div class="privacy-badge">
                    <span class="badge-icon">üõ°Ô∏è</span>
                    <span>Uw document verlaat nooit uw computer</span>
                </div>
            </div>

            <!-- Editor -->
            <div id="editor" class="editor hidden">
                <!-- Toolbar -->
                <div class="toolbar">
                    <div class="toolbar-left">
                        <button class="btn btn-icon" id="btn-back" title="Nieuw document">
                            <span>‚Üê</span>
                        </button>
                        <div class="divider-vertical"></div>
                        <button class="btn btn-icon" id="btn-zoom-out" title="Uitzoomen">
                            <span>‚ûñ</span>
                        </button>
                        <button class="btn btn-icon" id="btn-zoom-in" title="Inzoomen">
                            <span>‚ûï</span>
                        </button>
                        <div class="divider-vertical"></div>
                        <button class="btn btn-icon" id="btn-undo" title="Ongedaan maken" disabled>
                            <span style="font-size: 0.9em;">‚Ü©Ô∏è</span>
                        </button>
                        <button class="btn btn-icon" id="btn-redo" title="Opnieuw" disabled>
                            <span style="font-size: 0.9em;">‚Ü™Ô∏è</span>
                        </button>
                        <span class="filename" id="filename">document.pdf</span>
                    </div>
                    <div class="toolbar-center">
                        <div class="tool-group">
                            <button class="btn btn-tool active" id="tool-select" title="Selecteren">
                                <span>üëÜ</span> Selecteren
                            </button>
                            <button class="btn btn-tool" id="tool-redact" title="Zwartlakken">
                                <span>üñäÔ∏è</span> Zwartlakken
                            </button>
                        </div>
                        <button class="btn btn-secondary" id="btn-detect"
                            title="Start detectie (gebruikt AI indien ingesteld)">
                            <span>üîç</span> Auto-detectie
                        </button>
                    </div>
                    <div class="toolbar-right">
                        <button class="btn btn-primary btn-disabled" id="btn-export"
                            title="Controleer eerst alle pagina's">
                            <span>üíæ</span> Exporteer veilige PDF
                        </button>
                        <button class="btn btn-secondary" id="btn-audit-log" title="Download overzicht van redacties"
                            style="margin-left: 8px; border: 1px solid var(--border-color);">
                            <span>üìã</span> Logboek
                        </button>
                    </div>
                </div>

                <!-- Validation Progress Bar -->
                <div id="validation-bar" class="validation-bar hidden">
                    <div class="validation-info">
                        <span id="validation-count">0</span> van <span id="validation-total">0</span> pagina's
                        gecontroleerd
                        <span class="shortcut-hint" style="margin-left: 15px; font-size: 0.85em; opacity: 0.8;">
                            (Tip: <strong>Shift + Enter</strong> om goed te keuren)
                        </span>
                    </div>
                    <button id="btn-validate-all" class="btn-text-small" title="Alles in √©√©n keer goedkeuren"
                        style="margin-right: 15px; background: none; border: none; color: var(--accent-success); cursor: pointer; text-decoration: underline; font-size: 0.9em; padding: 0;">
                        ‚úÖ Alles goedkeuren
                    </button>
                    <div class="validation-progress-track">
                        <div id="validation-progress-fill" class="validation-progress-fill" style="width: 0%"></div>
                    </div>
                </div>

                <!-- Editor Content -->
                <div class="editor-layout">
                    <!-- Sidebar -->
                    <aside class="sidebar">
                        <div class="sidebar-section">
                            <h3>Zoeken</h3>
                            <div class="search-container">
                                <input type="text" id="search-input" placeholder="Zoek en lak zwart..."
                                    class="search-input">
                            </div>
                            <div id="search-results" class="detections-list hidden">
                                <!-- Search results will appear here -->
                            </div>
                        </div>

                        <div class="sidebar-section">
                            <h3>Gevonden gegevens</h3>
                            <div id="detections-list" class="detections-list">
                                <p class="empty-state">Klik op "Auto-detectie" om te scannen</p>
                            </div>
                        </div>
                        <div class="sidebar-section">
                            <h3>Redacties</h3>
                            <div id="redactions-list" class="redactions-list">
                                <p class="empty-state">Nog geen redacties toegevoegd</p>
                            </div>
                            <button class="btn btn-warning btn-small hidden" id="btn-clear-learning"
                                style="margin-top: 10px; width: 100%;">
                                üß† Wis geleerde woorden
                            </button>
                        </div>
                        <div class="sidebar-section">
                            <h3>Metadata</h3>
                            <div id="metadata-info" class="metadata-info">
                                <p class="empty-state">Laad document om te zien</p>
                            </div>
                            <button class="btn btn-warning btn-small" id="btn-clear-metadata">
                                üóëÔ∏è Wis alle metadata
                            </button>
                        </div>
                    </aside>

                    <!-- PDF Viewer - Scrollable -->
                    <div class="pdf-viewer-container">
                        <div class="pdf-controls">
                            <button class="btn btn-icon" id="btn-zoom-out">‚àí</button>
                            <span id="zoom-level">100%</span>
                            <button class="btn btn-icon" id="btn-zoom-in">+</button>
                            <span class="separator">|</span>
                            <span>Pagina <span id="current-page">1</span> / <span id="total-pages">1</span></span>
                        </div>
                        <!-- Scrollable pages container -->
                        <div class="pdf-viewer" id="pdf-viewer">
                            <div id="pages-container" class="pages-container">
                                <!-- Pages will be rendered here dynamically -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Info Panel -->
        <section class="info-panel">
            <h2>Wat wordt gedetecteerd?</h2>
            <div class="category-grid">
                <div class="category-card">
                    <span class="category-icon">üë§</span>
                    <div class="category-content">
                        <h4>Namen & ID's</h4>
                        <p>BSN, IBAN, e-mail, telefoonnummers</p>
                    </div>
                </div>
                <div class="category-card">
                    <span class="category-icon">‚úçÔ∏è</span>
                    <div class="category-content">
                        <h4>Handtekeningen</h4>
                        <p>Automatisch herkend via tekstpatronen</p>
                    </div>
                </div>
                <div class="category-card">
                    <span class="category-icon">üìç</span>
                    <div class="category-content">
                        <h4>Locaties</h4>
                        <p>Adressen, postcodes</p>
                    </div>
                </div>
                <div class="category-card">
                    <span class="category-icon">üß†</span>
                    <div class="category-content">
                        <h4>Slim leren</h4>
                        <p>Leert van uw handmatige redacties</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <p>‚ö†Ô∏è <strong>Let op:</strong> Deze tool helpt, maar controleer altijd handmatig op indirecte
                identificatoren!</p>
        </footer>
    </div>

    <!-- Detection Modal -->
    <div id="detection-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üîç Automatische Detectie</h3>
                <button class="btn btn-icon modal-close" id="modal-close">‚úï</button>
            </div>
            <div class="modal-body">
                <div id="detection-progress" class="detection-progress">
                    <div class="spinner"></div>
                    <p>Scannen op persoonsgegevens...</p>
                </div>
                <div id="detection-results" class="detection-results hidden">
                    <!-- Results will be inserted here -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="btn-cancel-detection">Annuleren</button>
                <button class="btn btn-primary hidden" id="btn-apply-detections">Redacteer geselecteerde</button>
            </div>
        </div>
    </div>

    <!-- Core Scripts -->
    <script src="persistence.js"></script>
    <script src="redactor.js"></script>
    <script src="detector.js"></script>
    <script src="app.js"></script>
    <script src="app.js"></script>
</body>

</html>